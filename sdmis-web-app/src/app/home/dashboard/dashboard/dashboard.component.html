<div class="container">
    <div class="mb-4 d-flex align-items-center">
        <div class="ml-4 mb-4">
            <span class="page-head">DASHBOARD</span>
            <div *ngIf="common.schoolDetail?.udiseCode && viewDashLevel== 'school'" class="page-head font-low mt-3">
                {{common.schoolDetail.schoolName}} ({{common.schoolDetail?.udiseCode}})</div>
        </div>
        <div class="ml-auto mr-5" *ngIf="(userObj.userType=='B' && viewDashLevel== 'school')">
            <button type="button" mat-raised-button color="primary" class="btn-gradient"
                (click)="originalDash()">Back</button>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3" *ngIf="totalCreated">
            <mat-card class="dash-card">
                <div class="dashboard-card-head">
                    Total Students in {{(userObj.userType == 'S') ? 'school' : 'block'}}
                </div>
                <div class="total-chart">
                    <canvas baseChart chartType="doughnut" [data]="doughnutChartData" [options]="chartOptions"
                        [legend]="false" [colors]="chartColors">
                    </canvas>
                    <div class="text-chart">
                        {{profileSum}}
                    </div>
                </div>
                <div class="chart-legend">
                    <ul class="list-unstyled">
                        <li *ngFor='let label of schoolChartMasterData' class="mr-3 mb-2 d-flex align-items-center">
                            <div [ngClass]="label.class=='complete' ? 'complete-profile' : 'remaining-profile'"
                                class="legend-layout"></div>
                            <div class="label-name">
                                {{label.name}}
                            </div>
                            <div class="ml-auto label-count">
                                {{label.count}}
                            </div>
                        </li>
                    </ul>
                </div>
            </mat-card>
        </div>

        <div class="col-md-9" *ngIf="classWiseCreated">
            <mat-card class="dash-card">
                <div class="dashboard-card-head">
                    Students class wise
                </div>

                <div class="row" *ngIf="classWiseData.length > 6">
                    <div class="col-md-6 pr-5">
                        <div class="class-wise-head">Classes:</div>
                        <ul class="list-unstyled">
                            <li *ngFor='let classWise of classWiseData'>
                                <div class="d-flex align-items-center classwise-chart"
                                    *ngIf="classWise.classNum % 2 != 0">
                                    <div class="class-wise-label">{{classWise.classRoman}}</div>

                                    <mat-progress-bar class="blue-progress mr-3" mode="determinate"
                                        [value]="classWise.count / classwiseMaxStd * 100">
                                    </mat-progress-bar>

                                    <div class="class-wise-count">{{classWise.count}}</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-6 pl-5">
                        <div class=" class-wise-head">Classes:</div>
                        <ul class="list-unstyled">
                            <li *ngFor='let classWise of classWiseData'>
                                <div class="d-flex align-items-center classwise-chart"
                                    *ngIf="classWise.classNum % 2 == 0">
                                    <div class="class-wise-label">{{classWise.classRoman}}</div>

                                    <mat-progress-bar class="blue-progress mr-3" mode="determinate"
                                        [value]="classWise.count / classwiseMaxStd * 100">
                                    </mat-progress-bar>

                                    <div class="class-wise-count">{{classWise.count}}</div>
                                </div>


                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row" *ngIf="classWiseData.length <= 6">
                    <div class="col-md-12 pr-5">
                        <div class="class-wise-head">Classes:</div>
                        <ul class="list-unstyled">
                            <li *ngFor='let classWise of classWiseData'>
                                <div class="d-flex align-items-center classwise-chart">
                                    <div class="class-wise-label">{{classWise.classRoman}}</div>

                                    <mat-progress-bar class="blue-progress mr-3" mode="determinate"
                                        [value]="classWise.count / classwiseMaxStd * 100">
                                    </mat-progress-bar>

                                    <div class="class-wise-count">{{classWise.count}}</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

            </mat-card>
        </div>
    </div>
    <div class="row">
        <div class="profile-parent w-100" *ngIf="sectionWiseCreated">
            <ul class="list-unstyled d-flex">
                <li *ngFor="let profile of profileWiseData" style="width: 20%">
                    <mat-card class="profile-card">
                        <div class="profile-head">{{profile.count}}</div>
                        <div class="mt-3">{{profile.displayText}}</div>
                        <mat-progress-bar class="green-progress mt-3" mode="determinate"
                            [value]="profile.count / profileWiseMaxStd * 100">
                        </mat-progress-bar>
                    </mat-card>
                </li>
            </ul>
        </div>
    </div>

    <div *ngIf="tableDataCreated" class="table-list">
        <div *ngIf="viewDashLevel== 'block' ">
            <div class="font-weight-bold mb-3 pt-5">Click on the school name below to view it's progress</div>
            <div class="text-right mt-5">
                <input type="text" class="custom-input" placeholder="Search..."
                    (keyup)="applyFilter($event.target.value)">
            </div>
            <table mat-table [dataSource]="tableData" class="w-100 mt-3">
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef>School Name</th>
                    <td mat-cell *matCellDef="let element"> {{element.schName}} </td>
                </ng-container>
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>UDISE Code</th>
                    <td mat-cell *matCellDef="let element"> {{element.udiseCode}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="tableColumn"></tr>
                <tr mat-row *matRowDef="let element; columns: tableColumn;" (click)="getSchoolDash(element.udiseCode)">
                </tr>
            </table>
            <mat-paginator [pageSizeOptions]="[10, 15, 20, 15, 30]"></mat-paginator>
        </div>

    </div>
</div>


<div *ngIf='alertFlag'>
    <app-alert [message]='alertMsg' [flag]='alertFlag' [count]='alertCount'></app-alert>
</div>